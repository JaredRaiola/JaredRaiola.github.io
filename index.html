<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="refresh" content="120" >
	<!-- Author: Jared Raiola -->
	<title>Locator</title>
	<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
	<link rel="icon" href="images/favicon.ico" type="image/x-icon">
	<link rel="stylesheet" type="text/css" href="ieindex.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

</head>
<!-- onload write IT dep page -->
<body>
	<!-- Don't delete :) thx -->
	<div class="duck" id="duck"></div>
	<!-- Title card, contains logo, date, department, and buttons -->
	<div class="card" id="title">
		<img src="images/ITandGIS.png" style="width:170px;height:96px;" onclick="duckDuckGoose()">
		<br>
		<br>
		<!-- Date -->
		<div class="formTitle" id="dateTime"></div>
		<!-- Script to show date -->
		<script>
			var dt = new Date();
			document.getElementById("dateTime").innerHTML = dt.toDateString();
		</script>
		<br>
		<div id="step-name" class="title"><b>IT Department</b></div></th>
	</div>
	<!-- Main display, holds employees -->
	<div class="card" id="main">
		<!-- Column 1 -->
		<div class="column">
	    <div id="entries">
	      <!-- filled in on-load -->
			</div>
		</div>
		<!-- Column 2 -->
		<div class="column">
	    <div id="entries2">
	      <!-- filled in on-load -->
			</div>
		</div>
		<!-- Column 3 -->
		<div class="column">
	    <div id="entries3">
	      <!-- filled in on-load -->
			</div>
		</div>
	</div>

	<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-database.js"></script>
	<script>
		var firebaseConfig = {
		apiKey: "AIzaSyAUSImSSuLVmng1bwaKsf-7SmMg9PKUgNU",
		authDomain: "touchscreen-app.firebaseapp.com",
		databaseURL: "https://touchscreen-app.firebaseio.com",
		projectId: "touchscreen-app",
		storageBucket: "touchscreen-app.appspot.com",
		messagingSenderId: "949468004343",
		appId: "1:949468004343:web:fa3c79797f9f7980"
		};
		// Initialize Firebase
		firebase.initializeApp(firebaseConfig);

		var loopCount = 0;

		window.onload = function displayPeople() {
		var depName = "IT"
	  //This loop reads in from firebase
	  var fbRef = firebase.database().ref(depName + "/");
	  fbRef.once("value", function(person) {
	      person.forEach(function (inPerson){
	      		//increment newID per person to handle the case when adding a new person
	          //if first person, put in column 1
	          if (loopCount == 0) {
	              loopCount++;
	              $("#entries").append(rowForPerson(inPerson.val()));
	          //if second person, put in column 2
	          } else if (loopCount == 1) {
	              loopCount++;
	              $("#entries2").append(rowForPerson(inPerson.val()));
	          //if third person put in column three and reset to first person
	          } else {
	              loopCount = 0;
	              $("#entries3").append(rowForPerson(inPerson.val()));
	          }
	          //changes the color of a persons background based off which location they picked
	          //state 1 is "In"
	          if (inPerson.val().state == 1) {
	              document.getElementById(inPerson.val().id.toString()).style.background='rgb(152,251,152)';
	          //state 2 is "Lunch"
	          } else if (inPerson.val().state == 2) {
	              document.getElementById(inPerson.val().id.toString()).style.background='rgb(135,206,250)';
	          //state 3 is "Home"
	          } else if (inPerson.val().state == 3) {
	              document.getElementById(inPerson.val().id.toString()).style.background='rgb(220,20,60)';
	          //state 4 is "Vacation"
	          } else if (inPerson.val().state == 4) {
	              document.getElementById(inPerson.val().id.toString()).style.background='rgb(255,182,193)';
	          }
	          //any other state just rewrites as the normal background
	      });
	  });
	}

	function rowForPerson(person) {
	  return rowOfPeople(person.id, 
	           person.name,
	           person.state,
	           person.location);
	}

	function rowOfPeople(id, name, state, location) {
	  return '<div class="entry" id=' + id + '><div class="info"><img class="image" src="images/1.jpg"><div class="name">' + name + '</div><br></div><div class="selection"><span class="attribute-button unselected" id="'+ id +'-1">' + location + '</span></div></div>'
	}
	</script>
</body>

</html>